<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>ã€25æ—¶ã€Nightcordè§ã€‚ã€æˆå‘˜ä»¬çš„ 24 å°æ—¶å·¥ä½œæ—¥å¸¸</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="app">
    <video id="video" autoplay muted playsinline preload="metadata"></video>
      <div id="overlay">
        <div id="info">
          Time (<span id="tzLabel">Local</span>): <span id="localTime">--:--:--</span>
          &nbsp;â€¢&nbsp; Part: <span id="partName">-</span>
        </div>

        <div id="controls" role="toolbar" aria-label="Video controls">
          <button id="muteBtn" aria-pressed="true" title="Mute / Unmute">ğŸ”Š</button>
          <input id="volumeSlider" type="range" min="0" max="1" step="0.05" value="1" aria-label="Volume" />
          <button id="fullscreenBtn" title="Fullscreen">Fullscreen</button>
          <button id="tzToggleBtn" title="Toggle timezone">Toggle TZ</button>
          <button id="pomodoroBtn" title="Pomodoro Timer">ğŸ…</button>
          <button id="cdPlayerBtn" title="CD Player">ğŸ’¿</button>
        </div>

        <!-- Pomodoro Timer Panel -->
        <div id="pomodoroPanel" class="hidden">
          <div class="pomodoro-header">
            <span>ç•ªèŒ„é’Ÿ & ä¸–ç•Œæ—¶é’Ÿ</span>
            <div class="header-controls">
              <button id="toggleClockWidget" class="toggle-btn" title="æ˜¾ç¤º/éšè—æ—¶é’Ÿ">ğŸ•</button>
              <button id="pomodoroCloseBtn" class="close-btn" title="å…³é—­">âœ•</button>
            </div>
          </div>
          
          <!-- Main Content: Left-Right Layout -->
          <div class="pomodoro-main-content">
            <!-- Left Side: World Clock Section -->
            <div class="world-clock-section" id="worldClockSection">
              <div class="clock-item main-clock">
                <div class="clock-label">æœ¬åœ°æ—¶é—´</div>
                <div class="clock-time-large">
                  <span class="time-hours" id="localHours">00</span>
                  <span class="time-separator">:</span>
                  <span class="time-minutes" id="localMinutes">00</span>
                  <span class="time-separator">:</span>
                  <span class="time-seconds" id="localSeconds">00</span>
                  <span class="time-milliseconds" id="localMilliseconds">.000</span>
                </div>
                <div class="clock-date" id="localDate">2025å¹´12æœˆ7æ—¥ æ˜ŸæœŸå…­</div>
              </div>
              
              <div class="world-clocks-grid">
                <div class="clock-item-small">
                  <select class="clock-select" id="clock1Select" title="é€‰æ‹©æ—¶åŒº"></select>
                  <div class="clock-time-small" id="clock1Container">
                    <span class="time-hms" id="clock1Time">00:00:00</span>
                  </div>
                </div>
                <div class="clock-item-small">
                  <select class="clock-select" id="clock2Select" title="é€‰æ‹©æ—¶åŒº"></select>
                  <div class="clock-time-small" id="clock2Container">
                    <span class="time-hms" id="clock2Time">00:00:00</span>
                  </div>
                </div>
                <div class="clock-item-small">
                  <select class="clock-select" id="clock3Select" title="é€‰æ‹©æ—¶åŒº"></select>
                  <div class="clock-time-small" id="clock3Container">
                    <span class="time-hms" id="clock3Time">00:00:00</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Right Side: Pomodoro Timer -->
            <div class="pomodoro-body">
              <div id="pomodoroDisplay" class="pomodoro-display">25:00</div>
              <div class="pomodoro-status">å‡†å¤‡å·¥ä½œ</div>
              <div class="pomodoro-controls">
                <button id="pomodoroStartBtn" class="pomodoro-btn primary">å¼€å§‹</button>
                <button id="pomodoroPauseBtn" class="pomodoro-btn" disabled>æš‚åœ</button>
                <button id="pomodoroResetBtn" class="pomodoro-btn">é‡ç½®</button>
              </div>
              <div class="pomodoro-settings">
                <div class="setting-item">
                  <label>å·¥ä½œæ—¶é•¿ (åˆ†é’Ÿ):</label>
                  <input type="number" id="workDuration" min="1" max="60" value="25" />
                </div>
                <div class="setting-item">
                  <label>çŸ­ä¼‘æ¯ (åˆ†é’Ÿ):</label>
                  <input type="number" id="shortBreak" min="1" max="30" value="5" />
                </div>
                <div class="setting-item">
                  <label>é•¿ä¼‘æ¯ (åˆ†é’Ÿ):</label>
                  <input type="number" id="longBreak" min="1" max="60" value="15" />
                </div>
                <div class="setting-item">
                  <label>å·¥ä½œè½®æ¬¡:</label>
                  <span id="pomodoroRound">0 / 4</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- CD Player Panel -->
      <div id="cdPlayerPanel" class="hidden">
        <div class="cd-player-header">
          <span>ğŸµ SEKAI ç•™å£°æœº</span>
          <div class="header-controls">
            <button id="toggleVisualization" class="toggle-btn" title="æ˜¾ç¤º/éšè—éŸ³é¢‘å¯è§†åŒ–">ğŸ¨</button>
            <button id="cdPlayerCloseBtn" class="close-btn" title="å…³é—­">âœ•</button>
          </div>
        </div>
        
        <div class="cd-player-body">
          <!-- Music List -->
          <div class="music-list-section">
            <!-- Category Sidebar -->
            <div class="music-categories" id="musicCategories">
              <button class="category-btn active" data-category="all" title="å…¨éƒ¨æ­Œæ›²">ğŸµ</button>
              <button class="category-btn" data-category="favorites" title="æˆ‘å–œæ¬¢çš„éŸ³ä¹">â­</button>
              <button class="category-btn" data-category="playlists" title="æˆ‘çš„æ­Œå•">ğŸ“‚</button>
              <button class="category-btn" data-category="local" title="æœ¬åœ°éŸ³ä¹">ğŸ“¥</button>
              <div style="height: 1px; background: rgba(255,255,255,0.1); margin: 4px 8px;"></div>
              <button class="category-btn" data-category="virtual_singer" title="Virtual Singer">
                <img src="https://pj-sekai.oss-cn-shanghai.aliyuncs.com/unit_logos/vs.webp" alt="VS" />
              </button>
              <button class="category-btn" data-category="leo_need" title="Leo/need">
                <img src="https://pj-sekai.oss-cn-shanghai.aliyuncs.com/unit_logos/ln.webp" alt="L/n" />
              </button>
              <button class="category-btn" data-category="more_more_jump" title="MORE MORE JUMP!">
                <img src="https://pj-sekai.oss-cn-shanghai.aliyuncs.com/unit_logos/mmj.webp" alt="MMJ" />
              </button>
              <button class="category-btn" data-category="vivid_bad_squad" title="Vivid BAD SQUAD">
                <img src="https://pj-sekai.oss-cn-shanghai.aliyuncs.com/unit_logos/vbs.webp" alt="VBS" />
              </button>
              <button class="category-btn" data-category="wonderlands_x_showtime" title="WonderlandsÃ—Showtime">
                <img src="https://pj-sekai.oss-cn-shanghai.aliyuncs.com/unit_logos/ws.webp" alt="WxS" />
              </button>
              <button class="category-btn" data-category="25_ji_nightcord_de" title="25æ—¶ï¼Œåœ¨Nightcordã€‚">
                <img src="https://pj-sekai.oss-cn-shanghai.aliyuncs.com/unit_logos/25ji.webp" alt="25æ—¶" />
              </button>
              <button class="category-btn" data-category="other" title="å…¶ä»–">ğŸ“€</button>
            </div>

            <div class="music-list-container">
              <div class="music-search">
                <input type="text" id="musicSearchInput" placeholder="æœç´¢æ­Œæ›²..." />
              </div>
              <div class="music-list" id="musicList">
                <div class="loading">åŠ è½½ä¸­...</div>
              </div>
            </div>
          </div>

          <!-- Now Playing -->
          <div class="now-playing-section">
            <div class="album-cover-container">
              <canvas id="visualizerCanvas" width="400" height="400"></canvas>
              <img id="albumCover" src="https://pj-sekai.oss-cn-shanghai.aliyuncs.com/mysekai/music_record_soundtrack/jacket/jacket_s_soundtrack_1.png" alt="Album Cover" class="album-cover" crossorigin="anonymous" />
              <div class="cd-animation" id="cdAnimation"></div>
              <div id="trackLoadingSpinner" class="track-loading-spinner hidden">
                <div class="spinner-icon"></div>
              </div>
            </div>
            
            <div class="track-info">
              <div class="track-title" id="trackTitle">é€‰æ‹©ä¸€é¦–æ­Œæ›²</div>
              <div class="track-artist" id="trackArtist">-</div>
              <div class="track-vocal" id="trackVocal">-</div>
            </div>

            <!-- Audio Player Controls -->
            <div class="player-progress">
              <span class="time-current" id="currentTime">0:00</span>
              <input type="range" id="progressBar" min="0" max="100" value="0" step="0.1" />
              <span class="time-total" id="totalTime">0:00</span>
            </div>

            <div class="player-controls">
              <button id="prevBtn" class="control-btn" title="ä¸Šä¸€é¦–">â®</button>
              <button id="playPauseBtn" class="control-btn play-btn" title="æ’­æ”¾/æš‚åœ">â–¶ï¸</button>
              <button id="nextBtn" class="control-btn" title="ä¸‹ä¸€é¦–">â­</button>
              <button id="shuffleBtn" class="control-btn" title="éšæœºæ’­æ”¾">ğŸ”€</button>
              <button id="repeatBtn" class="control-btn" title="å¾ªç¯æ’­æ”¾">ğŸ”</button>
            </div>

            <div class="volume-control">
              <span>ğŸ”Š</span>
              <input type="range" id="cdVolumeSlider" min="0" max="1" step="0.01" value="0.7" />
            </div>
          </div>
        </div>

        <!-- Hidden Audio Element -->
        <audio id="cdAudioPlayer" preload="metadata"></audio>
      </div>
  </div>

  <script>
  // Default sources - replace or override with query params ?p1=...&p2=...&p3=...
  const DEFAULT_SOURCES = {
    p1: 'https://houtar-disk.oss-cn-shanghai.aliyuncs.com/nightcord/p01.mp4',
    p2: 'https://houtar-disk.oss-cn-shanghai.aliyuncs.com/nightcord/p02.mp4',
    p3: 'https://houtar-disk.oss-cn-shanghai.aliyuncs.com/nightcord/p03.mp4'
  };

  function parseSourcesFromURL() {
    const url = new URL(window.location.href);
    const s = { ...DEFAULT_SOURCES };
    ['p1','p2','p3'].forEach(k => {
      if (url.searchParams.get(k)) s[k] = url.searchParams.get(k);
    });
    return s;
  }

  // make sources globally available to script.js
  window.TIME_SYNC_SOURCES = parseSourcesFromURL();
  </script>

  <script src="script.js"></script>
</body>
</html>
